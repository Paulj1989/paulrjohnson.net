{
  "hash": "478ec4df5e528d5e4fdd233c30fd47ad",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Analysing the Effect of Money in Football Using Multilevel Regression\nsubtitle: |\n  Analysing football club resources and league performance using MLMs\ndescription-meta: |\n  Developing a multilevel model to measure the effect of football (soccer) club \n  resources on league points, goals, and expected goals in Europe's top five \n  leagues.\ndate: 2024-09-29\nimage: money.webp\nimage-alt: |\n  A photograph of many â‚¬100 bank notes layered on top of each other.\ncategories: [Multilevel Regression, Statistics, R]\nbibliography: references.bib\n---\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Setup Code (Click to Expand)\"}\n# import packages\nsuppressPackageStartupMessages({\n  library(dplyr)\n  library(lme4)\n  library(gt)\n  library(ggplot2)\n})\n\n# setup fonts\nsysfonts::font_add_google(\"Poppins\")\nsysfonts::font_add_google(\"Lora\")\nshowtext::showtext_auto()\n\n# set plot theme\n# inspired by https://github.com/z3tt/TidyTuesday/blob/main/R/2020_31_PalmerPenguins.Rmd\ntheme_set(theme_minimal(base_size = 20, base_family = \"Poppins\")) +\n  theme_update(\n    panel.grid.major = element_line(color = \"grey90\", linewidth = .4),\n    panel.grid.minor = element_blank(),\n    panel.spacing.x = unit(.65, units = \"cm\"),\n    panel.spacing.y = unit(.3, units = \"cm\"),\n    axis.title.x = element_text(\n      color = \"grey30\", margin = margin(t = 5), size = rel(1.05)\n      ),\n    axis.title.y = element_text(\n      color = \"grey30\", margin = margin(r = 5), size = rel(1.05)\n      ),\n    axis.text = element_text(color = \"grey50\", size = rel(1)),\n    axis.text.x = element_text(angle = 30, vjust = 1, hjust = .75),\n    axis.ticks = element_line(color = \"grey90\", linewidth = .4),\n    axis.ticks.length = unit(.2, \"lines\"),\n    legend.position = \"top\",\n    legend.title = element_blank(),\n    legend.text = element_text(size = rel(.9)),\n    legend.box.margin = margin(0, 0, -10, 0),\n    legend.key.width = unit(1, units = \"cm\"),\n    plot.title = element_text(\n      hjust = 0, color = \"black\", family = \"Lora\",\n      size = rel(1.5), margin = margin(t = 5, b = 5)\n    ),\n    plot.subtitle = element_text(\n      hjust = 0, color = \"grey30\", family = \"Lora\",\n      lineheight = 0.5, size = rel(1.1), \n      margin = margin(5, 0, 5, 0)\n    ),\n    plot.title.position = \"plot\",\n    plot.caption = element_text(\n      color = \"grey50\", size = rel(0.8), hjust = 1,\n      margin = margin(10, 0, 0, 0)\n    ),\n    plot.caption.position = \"plot\",\n    plot.margin = margin(rep(10, 4)),\n    strip.text = element_text(size = rel(1), margin = margin(0, 0, 5, 0)),\n    strip.clip = \"off\"\n  )\n\n# set table theme\ntbl_theme <-\n  function(data, width = 100, align = \"center\") {\n    data |>\n      tab_source_note(\n        source_note = \"Source: FBref & Transfermarkt Via {worldfootballR}\"\n        ) |>\n      tab_options(\n        table.width = pct(width), \n        table.align = align,\n        table.font.names = \"Poppins\"\n        )\n  }\n\n# load data\nclub_resources <- \n  readr::read_rds(\n    here::here(\n      \"blog\", \"2024-09-29-analysing-money-in-football\", \n      \"data\", \"club_resources.rds\"\n      )\n  )\n```\n:::\n\n::: {.cell}\n<style type=\"text/css\">\n.rm-striping .gt_table tr.odd {\n  --bs-table-striped-bg: transparent;\n}\n</style>\n:::\n\n\n\nBuilding a brand is an important step in any career that involves any public-facing or portfolio-based work. When we finally decide to gig economy all the jobs in an attempt to finally achieve the goal of implementing a perfectly awful capitalist hellscape, the first to go will be the folks that were too busy \"being with their family\", \"seeing the world\", or \"living a rich and fulfilling life\" to build their **brand**. While some people are blessed with names like [Adam L. Ozer](https://adamlozer.github.io)[^Loser], those of us who were given names so generic and not remotely funny that we are never more than ten metres away from a namesake have to work a little harder to distinguish ourselves. I could wear a hat, I suppose, but that seems like an awful lot of upkeep. I'd have to buy the hat, and then I'd have to wear it, and I assume I'd have to wash it sometimes too[^Hats]. No. That won't do. I'd much rather build a brand around having One Neat Trick. Like Daron Acemoglu with instrumental variables, except without any of the high-quality research and none of the prolific work-rate.\n\nLuckily, I already know what my One Neat Trick is. It's multilevel models[^Innovation]. I really like multilevel regression models. I recommend them for most problems, usually long before I'm sure they are necessary. I assume that most problems will eventually reveal some multilevel data that justifies the use of a multilevel model, and once you've convinced yourself that this particular hammer does actually turn everything into a nail, it's hard to roll that back. I'm fortunate that in this case I'm not far from the truth. It's good that I didn't pick Tobit regression[^Tobits]. \n\nSo when I was inspired to take a deeper look at the effect that financial resources have on outcomes in football, because a [tweet](https://x.com/SBienkowski/status/1561464135279329280) had me mad on the Internet[^Tweet], I assumed it was probably going to be a multilevel model. I'm interested in understanding just how much of an impact money has on football, and whether it really all comes down to just spending your way to the top of the table. I have leveraged Transfermarkt's squad values as a proxy for a club's financial powers and used outcomes in Europe's big five leagues, from 2012/13 to 2023/24, to estimate the effect that resources have on league performance. It probably goes without saying that the results suggest that having money is good and that teams with lots of money tend to be better at football, but there's some relatively interesting nuance in there too, so this blog post wasn't a complete waste of time. \n\nI'm still unsure if this blog post is really more about multilevel regression or about money in football, but the beauty of running your own silly little blog is that you can write posts that meander aimlessly and if someone has the misfortune to read it all, that's on them. Anyway, lets find out where this one heads.\n\n[^Loser]:\n    \n    His name is Adam **LOSER**.\n\n[^Hats]:\n\n    Yes I know you have to wash hats.\n\n[^Innovation]:\n\n    Which, to be clear, is a method I have had no hand in the development or innovation in its use, nor have I inspired an entire methodological hype cycle around its use because of my work. I just like them.\n    \n[^Tobits]:\n\n    Please don't @ me if you use Tobits all the time. ~~You're probably very boring.~~ It's just a silly joke.\n\n[^Tweet]:\n\n    The eagle-eyed among you will notice that the tweet in question is over two years old. I haven't spent the last two years so seething with rage that I am unable to concentrate on building my silly little model \n    that would prove Stefan wrong. I've just been kicking this idea around for a couple years and have finally got round to finishing it off.\n\n## Multilevel Models for Multilevel Problems\n\nMultilevel models address problems caused by clustered (or multilevel) data in standard linear (and generalised linear) models, namely, the violation of the assumption of independence. \n\nThe independence assumption is a central tenet of regression modelling that states that all residuals in a model should be independent. When data is clustered, observations within clusters will be correlated, leading to residuals that are also correlated (and therefore not independent). Clustered data effectively inflates the sample size[^Dependence], and a model that fails to account for this will underestimate the standard errors of parameter estimates. These smaller standard errors give the appearance of certainty where certainty does not exist.\n\nMultilevel models handle clustered data and the correlation between observations within clusters by explicitly modelling the grouping structures in the data. By modelling the grouping structures, this allows us to fit models at the population level while accounting for the unexplained variance among the groups [@gelman2006], which produces more appropriate standard errors. \n\nSo when you encounter multilevel data, there's a multilevel model for it!\n\n\n[^Dependence]:\n\n    Each observation is assumed to contribute equally independent information. Clustered data points, however, will be partially dependent, which makes some of the information contributed by each point redundant. \n    While the data may contain 100 observations, the information contributed will be equivalent to fewer truly independent observations.\n\n### The Prevalence of Multilevel Data\n\nMy first exposure to multilevel data came during my studies for a Political Science PhD. My primary field was comparative politics[^Comparative], and I was particularly interested in political parties and party systems. Being able to say anything meaningful about political parties that can be generalised across a wide range of contexts requires studying parties in lots of different countries. But it turns out every country is a special snowflake and there's lots of details that make them unique, so finding the golden nuggets of generalisable insight required controlling for those differences. This is a good example of data that is structured in multiple levels, or hierarchies in this case. Political parties are nested in countries, and countries are nested in regions or continents. Depending on the the nature of the question being studied, you might have further hierarchies in the data, like party families that group parties across Europe, or you might have other types of grouping structures in the data that are not hierarchical, like electoral outcomes grouping by year.\n\nMultilevel data can come in a variety of forms, but whenever you find clustering or groups in your data, this is a sign you're working with multilevel data. If you think that your data could be organised into groups for which observations within-group will be more similar to each other than they are to the rest of the observations, you should be thinking about the problems that arise from clustered data and how you might account for the grouping structures in your data. That doesn't necessarily have to mean a multilevel model, but multilevel models are certainly one of the best solutions.\n\nClustering is not just a quirk that you occasionally observe in the real-world, though. It is extremely common to observe multilevel data, because it turns out that lots of things we might be interested in studying can be organised in all manner of groups. The prevalence of multilevel data in the real-world is so great that @mcelreath2017 argues that our starting assumption should be that any data has grouping structures that need to be accounted and that multilevel regression should be our default model. Whether or not you think this stance is too aggressive, I think Richard is absolutely right to point out how common multilevel data is. Once you've learned about multilevel data it's impossible to look at any data and not see it. It's everywhere. Which is why multilevel regression is such a useful addition to the data science toolbox.\n\n[^Comparative]:\n\n    The field you pick when you don't want to know anything about any particular country's politics and just want to interject with your annoying little opinions when any politics comes up.\n\n### Models with Memory...\n\nThe existence of clustering in your data complicates any attempts to model an outcome of interest at the population-level, making it necessary to split the population-level variance (the variance across all observations without accounting for grouping structure) into two components - within-group variance (variance across observations within the same group) and between-group variance (variance across groups). The between-group variance estimates how much groups differ from each other, on average, and tells us how much group-level factors influence the outcome, while the within-group variance, the remainder of the population-level variance after group differences have been accounted for, estimates how much observations differ from one another in a given group, telling us the unit-level differences that are not explained by the group that observation belongs to.\n\nI think the most intuitive way to understand how multilevel models work, at a conceptual level, is that put forward by Richard McElreath [-@mcelreath2023] in the multilevel models chapter of his Statistical Rethinking lectures[^Rethinking], which is embedded below. While the focus is on Bayesian methods, the early chapters of the video talk in general enough terms to apply to frequentist multilevel models too. \n\n\n\n{{< video https://youtu.be/iwVqiiXYeC4?si=YmR8plIeBkQ2ufi5 >}}\n\n\n\n\n@mcelreath2023 describes multilevel models as \"models within models\". You are not fitting multiple models at the same time, but it can be helpful to think about a multilevel model as bringing together the information that comes from models of the different levels at which variance exists. The population-level model (again, a \"model\" from a conceptual but not technical perspective) estimates population-level effects, much like a single-level model, while group-level sub-models estimate the group-specific deviations from the population-level effects. The population model serves as a jumping off point for each sub-model, and in this sense the population model gives what McElreath describes as \"a kind of memory\" when fitting the sub-models.\n\n[^Rethinking]:\n\n    I will borrow heavily from McElreath's approach to explaining multilevel models from Statistical Rethinking [-@mcelreath2018; -@mcelreath2023], because any attempt by me to better it will probably be a complete mess. \n    If you find yourself thirsty for knowledge (about statistical modeling generally, including multilevel models) having read this blog post, Statistical Rethinking (in either book or video form) is a pretty good place \n    to start.\n\n#### ...Learn Faster \n\nWhen dealing with clustered data, a single-level model that controls for the grouping structure in the data leaves information on the table by treating each group as entirely independent of each other[^Independence]. To continue to riff off McElreath's idea of model memory, a single-level model will forget everything it has learned, whenever it switches clusters [@mcelreath2017]. But clusters that are of the same type will have common features. For example, in a regression model that estimates how party members behave under certain conditions, party members will be clustered by the political party, and while every political party will be different, there will also be inherent similarities that are very useful to factor in to a model.\n\nWhile single-level models leave a lot of information on the table, multilevel models retain information about other clusters by borrowing information from the overall population when estimating group-level effects, in a process called \"partial pooling\" (more on this in the following section). This process causes multilevel models to learn \"faster\" and more efficiently by leveraging information from across all groups when modelling group-level differences, and it allows multilevel models to reach stable point estimates with less data, because groups with smaller sample sizes can rely more heavily on the information borrowed from the population.\n\n[^Independence]:\n\n    As a reminder, a single-level model that doesn't account for grouping structure at all will not only leave a lot of information on the table by not considering the grouping structure as an explanatory variable, it will \n    also violate the independence assumption. That's bad. Don't do that.\n\n#### ...Resist Overfitting\n\nPartial pooling makes multilevel models both efficient and flexible, but in addition to this, shrinking group-level estimates towards the overall population mean serves as a form of regularisation[^Regularisation], striking a balance between underfitting[^Underfitting] and overfitting[^Overfitting].\n\nThis balance is a natural consequence of partial pooling, which itself finds a compromise between complete and no pooling. Complete pooling models all observations together, not accounting for any group effects, and fits a single global estimate. This leads to underfitting because the model is not complex enough to effectively model the variation in the data, with between-group variance that is an important part of the data generating process but is being ignored. On the other hand, models with no pooling treat groups as independent of each other, fitting separate models for each group. No pooling leads to overfitting, particularly with groups that have limited data, because the model doesn't use information from other groups that might help stabilise estimates, and without that additional context the model is more likely to treat the group-level noise as signal.\n\nThe partial pooling process is an \"adaptive compromise that achieves regularisation\" [@mcelreath2023]. It balances the risks of underfitting and overfitting by pooling information across the groups, shrinking all group-level estimates towards the overall population mean. The amount of shrinkage depends on how large a group's sample is and how much variance there is in that group. Groups with less data or high variance will shrink towards the population mean more. This means that extreme group-level estimates are less likely unless the group has a large enough sample and small enough variance to make it justifiable.\n\nWhile the motivation for moving away from single-level models when dealing with clustered data is the artificially small standard errors they will estimate, the reason to fall in love with multilevel models as the solution to clustered data is partial pooling. Partial pooling, which serves as a type of memory, makes multilevel models more efficient, faster, and less vulnerable to overfitting, and the consequence of all of this, is better point estimates. So clustered data is everywhere, and when dealing with clustered data a multilevel model will produce more realistic uncertainty estimates and more accurate point estimates. If you're not convinced by now you're a heathen.\n\n[^Regularisation]:\n\n    Regularisation is the process of deliberately constraining model parameters in order to discourage the model from fitting to the noise in the data in order to make the model more generalisable.\n    \n[^Underfitting]:\n\n    Underfitting describes a situation where a model is too simple and is unable to capture the true underlying structure of the data.\n    \n[^Overfitting]:\n\n    Overfitting, as you may have guessed, is the opposite of underfitting, where a model is too complex and it captures the observed data structure in detail, but in the process it also captures the \n    noise and idiosyncrasies of the sample data.\n\n## The Role of Money in Football\n\nHaving (hopefully) given you a decent overview of multilevel models conceptually, and demonstrated how much value they can add to so many problems, I suppose I should now make an effort to prove that the data we are using here is a good fit for a multilevel model.\n\nLet me shock you, for a second: I believe that football clubs with lots of money generally do better than those without. While I'm sure even readers that are not interested in football are well aware that money makes the goals go round, I don't think we know _exactly_ how much of an impact money can have on club outcomes. \n\nWe will model the association between club resource and league outcomes, primarily focusing on total points, but also goals and expected goals. Club resources will be captured using Transfermarkt squad values as a noisy proxy for the financial strength of a team. This is imperfect, by all means, but I think it's justifiable. Values for each player are crowdsourced by the nerds that make up the Transfermarkt community, with the goal being that these values will be an approximation of what a player would cost on the open market. This process relies on the wisdom of the crowds [@transfermarkt2021]. \n\nI think these values can be relied on to be a fine though imperfect estimate of a player's value in an open market (not a prediction of what they will actually sell for), and in this, a useful measure that can be leveraged here. The goal is to understand how a club's financial resources can impact their results on the pitch, and obviously the most important mechanism is investing in the squad (though there will be other factors - coaching and support staff, facilities, etc.). Build a better team, get better results! A reliable measure of squad value (and how it changes over time) should give some indication of how the club has invested in their team[^Spending], and this is what we're most interested in here.\n\n[^Spending]: \n\n    The assumption here is that every team spends, more or less, as much as their finances allow. We know that's not entirely true, since some clubs are extremely frugal, and others (many more, in fact) spend well beyond their \n    means. I think this distinction is unimportant. The interest in club resources is assuming they spend that money. It's just a little catchier to talk about money rather than the spending of that money.\n\n### Exploring Football's Multilevel Data\n\nFootball has some immediately obvious grouping structure. The promotion/relegation system explicitly organises teams hierarchically! I'm only looking at outcomes in the top divisions, but I am also looking at leagues in five different countries, which is going to be a source of some clustering in the data too. Since I am looking at outcomes over 12 seasons, the teams themselves will also be a huge source of clustering too, because inevitably certain teams will do more with their money than others and will regularly outperform others in the league.\n\n#### League Differences\n\nNot accounting for league differences would likely lead to Bayern Munich's dominance in the Bundesliga not being given enough weight and therefore the regression would undervalue the effect of financial resources. While Bayern are certainly one of the richest clubs in the world, there are plenty of teams across the big five leagues with at least comparable resources, and in the Premier League there are multiple teams with a lot more money. However, compared against the rest of the Bundesliga, Bayern have untold riches, and this has been a major contributing factor in their decade-long run of title-winning seasons. It is necessary to account for league effects, among other factors, to make sure details like this are not missed by the regression model.\n\nThis becomes more obvious when we plot the median squad market values in the big five leagues over time, as shown below. The massive resource advantage that the likes of Bayern Munich, Juventus, PSG, Real Madrid, and Barcelona hold over their league compatriots would potentially be masked by the huge amount of money in the Premier League. \n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Plot Code (Click to Expand)\"}\nclub_resources |> \n  group_by(league, season) |> \n  summarise(squad_value = median(squad_value)) |> \n  ggplot(aes(forcats::as_factor(season), squad_value, group = league, fill = league)) +\n  geom_col(position = \"dodge\", colour = \"#343a40\") +\n  geom_hline(yintercept = 0, colour = \"#343a40\") +\n  scale_fill_manual(values = c(\"#7AB5CC\", \"#026E99\", \"#FFA600\", \"#D93649\", \"#8C3431\")) +\n  scale_y_continuous(\n    labels = \n      scales::label_number(scale_cut = scales::cut_short_scale(), prefix = \"â‚¬\")\n    ) +\n  labs(\n    x = NULL, y = \"Squad Market Value\",\n    caption = \n      \"Visualisation: Paul Johnson  |  Data: Transfermarkt Via {worldfootballR}\"\n    ) +\n  theme(legend.key.width = unit(.8, units = \"cm\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/value-by-league-1.png){width=672}\n:::\n:::\n\n\n\nPlenty of Premier League teams have astronomical amounts of money when compared even against the rest of the big five leagues despite not coming close to mixing with the very richest teams in England. It's important to account for league differences so that those teams are being compared against their league competition, where their gigantic vault of gold is only a moderately-sized pot of gold. This disparity has only grown larger as time goes on. The Premier League really has far too much money.\n\n#### Squad Values\n\nOf course, just being rich isn't enough. What do rich clubs do with all that money? Well, besides Manchester United, they spend it on good players! We should expect that, on average, rich teams will build squads that are more valuable, and that teams that are valued higher by Transfermarkt will be more successful in the league. The plot below visualises how our three outcomes (points, goal difference, and expected goals (xG) difference) vary by squad market value, all split by league.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Plot Code (Click to Expand)\"}\nclub_resources |> \n  tidyr::pivot_longer(\n    cols = c(pts, xgd, gd),\n    names_to = \"outcome\",\n    values_to = \"value\"\n  ) |> \n  mutate(\n    outcome =\n      factor(\n        case_when(\n          outcome == \"pts\" ~ \"League Points\",\n          outcome == \"xgd\" ~ \"xG Difference\",\n          outcome == \"gd\" ~ \"Goal Difference\",\n          .default = outcome\n          ),\n        levels = c(\"League Points\", \"Goal Difference\", \"xG Difference\")\n      )\n  ) |> \n  ggplot(aes(squad_value, value)) +\n  geom_point(alpha = .4, size = .8, colour = \"#343a40\") +\n  geom_smooth(\n    method = lm, formula = y ~ log(x), colour = \"#026E99\",\n    se = FALSE, linewidth = 1.2\n  ) +\n  \n  facet_grid(rows = vars(outcome), cols = vars(league), scales = \"free_y\") +\n  scale_x_continuous(\n    labels = \n      scales::label_number(scale_cut = scales::cut_short_scale(), prefix = \"â‚¬\")\n    ) +\n  labs(\n    x = \"Squad Market Value\", y = NULL,\n    caption = \n      \"Visualisation: Paul Johnson  |  Data: Transfermarkt Via {worldfootballR}\"\n    ) +\n  theme(\n    panel.spacing.x = unit(.3, units = \"cm\"),\n    axis.text.x = element_text(angle = 30, vjust = 1, hjust = .75)\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/value-by-outcome-1.png){width=672}\n:::\n:::\n\n\n\nIt's clear that the value of a team's squad has a positive effect on all three outcomes, though that relationship is non-linear. It appears that increases in squad market value at the lower end of the range of values have a huge impact on each outcome but that this effect tails off, to varying degrees by outcome and league, as squad market value approaches the higher end of it's range. That sounds an awful lot like a logarithm function! The regression line fit to the data is done so using a log-transformed squad market value, and while it's not perfect, it does seem to do a reasonably good job of fitting the data, and it captures the apparent diminishing returns as squad market values get way out in front of the rest of the league.\n\nIt is also worth noting that while the relationship between squad value and the outcomes is similar across all five leagues, there is some variance, and this is most obvious up around the upper quartile of squad values for each league. The highest squad values are much larger in some leagues than others, as are the highest total values of each outcome (especially the league points, since these are constrained by a maximum number of points that any team could win, which varies by league). This illustrates how not accounting for league differences could bias a regression of market value's effects on league performance. \n\n#### Season Differences\n\nFinally, we can consider how these effects have changed over time, plotting the relationship between squad values and league points, split by time, below. The darker blue points are earlier seasons in the data and the lighter grey points are the most recent seasons[^Legend].\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Plot Code (Click to Expand)\"}\nclub_resources |>\n  ggplot(aes(squad_value, pts, colour = season)) +\n  geom_point(alpha = .6, size = 1.2) +\n  geom_smooth(\n    method = lm, formula = y ~ log(x), se = FALSE, linewidth = 1, alpha = .6\n    ) +\n  scale_colour_manual(\n    values =\n      c(\n        \"#026E99\", \"#10799E\", \"#2183A4\", \"#338DA9\", \"#4497AF\", \"#56A1B4\",\n        \"#69ABBA\", \"#7CB4C0\", \"#8FBDC6\", \"#A3C6CC\", \"#B8CED3\", \"#CDD6D9\"\n        ),\n    guide = FALSE\n    ) +\n  scale_x_continuous(\n    labels =\n      scales::label_number(scale_cut = scales::cut_short_scale(), prefix = \"â‚¬\")\n    ) +\n  labs(\n    title =\n      glue::glue(\n        \"Relationship Between Market Values & Points\"\n        ),\n    x = \"Squad Market Value\", y = \"League Points\",\n    caption =\n      glue::glue(\n        \"Visualisation: Paul Johnson  |  \",\n        \"Data: Transfermarkt Via {{worldfootballR}}\"\n        )\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/value-by-season-1.png){width=672}\n:::\n:::\n\n\n\nThere is a clear shift over time, with the earliest seasons seeing the greatest marginal gains in league points as squad values increase at the lower end of the values, and over time we see that curve flatten out a little. This is because, as more money is spent in the top five leagues each season, the gains you can get from those smaller increases in squad value are no longer there. It looks like teams are having to spend more to increase their points totals now, and the ceiling of squad values has increased with time too.\n\n[^Legend]:\n\n    I know I probably should have used a legend here, but seasons are discrete values and 12 different values in a legend is silly. If the colours were intended to do any more than just split the seasons up (as opposed to \n    actually needing to distinguish which season is which), I would have accepted my fate, or spent more time thinking of a better way of visualising this, but here we are. All you really need to see is the shifting of the \n    regression lines over time.\n\n### Estimating Squad Value Effects\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Data Code (Click to Expand)\"}\nregression_data <-\n  club_resources |>\n  tidyr::pivot_longer(\n    cols = c(pts, xgd, gd),\n    names_to = \"outcome\",\n    values_to = \"value\"\n  ) |>\n  mutate(\n    squad_value = datawizard::centre(log(squad_value)),\n    time = as.numeric(season) - 1,\n    outcome =\n      case_when(\n        outcome == \"pts\" ~ \"Points\",\n        outcome == \"gd\" ~ \"Goal Difference\",\n        outcome == \"xgd\" ~ \"xG Difference\",\n        .default = outcome\n      )\n  ) |>\n  tidyr::nest(.by = c(outcome))\n```\n:::\n\n\n\n\nThe previous section highlights multiple grouping structures that need to be accounted for in the data, which is fortunate because I've already spent a lot of time talking about multilevel models here, and that would have been a real waste of time. This exploratory work also identified that squad values appear to have a non-linear relationship with the three outcomes. The other detail that we can see from the variation within and between groups across the range of squad values is that not only does the mean value vary by league, but also the magnitude of squad value's effect on the three outcomes varies. Multilevel models can handle both of these types of variation quite easily. When the mean difference is allowed to vary between groups this is a varying intercepts model, and allowing the magnitude of the effect to vary by group is called a varying slopes model. When your model allows both, it is a varying intercepts & slopes model[^MLMs], and this is the kind of model we will use here. Both the slope and intercept differences were relatively small, but this was only at the league level. The biggest differences will occur at club-level, but this would have been a mess to visualise. \n\nThe regression models fit to the three outcomes - league points, goal difference, and xG difference - all have the same basic structure. Squad market value and time, a continuous variable with a minimum value of 0 (the 2012/13 season) and a maximum value of 12 (the 2023/24 season), are included in the model as population-level predictor variables. Squad values have been log-transformed and centred. The log-transformation was carried out to account for the decreasing marginal gains as squad values increase and the squad values were centred around a mean of zero in order to make the intercept value more meaningful. The time variable has been included  as a continuous variable to help account for changes in the distribution of outcomes over time (for example increasing disparities in outcomes between the best and worst teams). The grouping structures include team nested in league and a separate crossed grouping variable for season[^Structures]. \n\nWhile the model intercepts are allowed to vary according to each of these grouping structures, the squad value slopes are specified to vary by the nested league/team grouping. This means that the magnitude of the effect squad values have on outcomes is allowed to vary by league and team. We could have allowed the squad value effects to vary by season as well, given that there did appear to be some flattening of the curve of squad values association with league points over time, however, the differences were small and allowing the intercepts to vary should be sufficient, without inviting unnecessary complexity. The season grouping structure, in contrast to the population-level time variable (which is intended to capture trends), mostly serves to capture the fact that outcomes are not independent of each other in a given season. There are a finite number of points in a season, so if Man City win them all, there's none left for anyone else. Similarly, if Man City score 1000 goals, everyone else's goal difference will be much worse. \n\n<!-- - The null model suggests that there is plenty of variance that can be explained by the grouping variables. -->\n<!-- - The next step is to get a good sense of the way that the grouping structure should impact the outcome. -->\n<!-- - We can compare the performance of varying intercepts and varying intercepts & slopes models on each outcome, to see if there is an obvious winner. -->\n<!-- - I think the EDA we've done certainly points to varying intercepts, at a minimum, with some evidence that varying slopes would also be worth including in the model.  -->\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Helper Function Code (Click to Expand)\"}\nfit_mlms <- \n  function(data) {\n    lmer(\n      value ~ 1 + squad_value + time + (1 | league/squad) + \n        (0 + squad_value | league/squad) + (1 | season), \n      data = data, REML = TRUE,\n      control = lmerControl(optimizer = \"bobyqa\", optCtrl = list(maxfun = 200000))\n      )\n  }\n```\n:::\n\n\n\n- Had to fit slightly simpler model with no correlation between slopes and intercepts.\n- Explain inclusion of both time and season. Time included to control for the effect that time itself has, season included to control for the fact that each season is (more or less) independent of each other and outcomes within a season are correlated.\n\n- The results show that a varying intercepts & slopes model is generally better (and at a minimum is no worse), so we will stick to this.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Model Code (Click to Expand)\"}\nmodels <-\n  regression_data |> \n  mutate(\n    model = purrr::map(data, fit_mlms),\n    summary = purrr::map(model, broom.mixed::glance),\n    coefs = purrr::map(model, ~ broom.mixed::tidy(.x, conf.int = TRUE)),\n    preds = purrr::map(model, ~ predict(.x))\n  )\n```\n:::\n\n::: {#tbl-model-summary .cell tbl-cap='Multilevel Regressions of Club Resources\\' Effect on League Outcomes & Performance\n'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Table Code (Click to Expand)\"}\ncm <-\n  c(\n    \"(Intercept)\" = \"(Intercept)\",\n    \"squad_value\" = \"Squad Value\",\n    \"time\" = \"Time (Seasons)\",\n    \"SD (Intercept squadleague)\" = \"_Club_: Intercept Variance\",\n    \"SD (squad_value squad.league)\" = \"_Club_: Slope Variance\",\n    # \"Cor (Intercept~squad_value squadleague)\" = \n    #   \"_Club_: Intercept/Slope Correlation\",\n    \"SD (Intercept league)\" = \"_League_: Intercept Variance\",\n    \"SD (squad_value league)\" = \"_League_: Slope Variance\",\n    # \"Cor (Intercept~squad_value league)\" = \n    #   \"_League_: Intercept/Slope Correlation\",\n    \"SD (Intercept season)\" = \"_Season_: Intercept Variance\",\n    \"SD (Observations)\" = \"Residual Variance\"\n  )\n\nmodels |> \n  pull(model, name = outcome) |>\n  modelsummary::msummary(\n    statistic = 'conf.int', gof_omit = \"AIC|BIC\", coef_map = cm, \n    fmt = 2, output = \"gt\"\n    ) |> \n  tab_row_group(\n    label = md(\"**Group (Random) Effects**\"),\n    rows = 7:11\n  ) |>\n  tab_row_group(\n    label = md(\"**Population-Level (Fixed) Effects**\"),\n    rows = 1:6\n  ) |>\n  tab_footnote(\n    footnote = \"Time represented as integers 0-11 where 2012/13 = 0 and 2022/23 = 11.\",\n    locations =\n      cells_body(\n        columns = 1,\n        rows = 5\n      )\n  ) |>\n  tab_footnote(\n    footnote = \"Market value log-transformed and centred around grand mean.\",\n    locations =\n      cells_body(\n        columns = 1,\n        rows = 3\n      )\n    ) |>\n  fmt_markdown(columns = 1, rows = 7:11) |>\n  tab_style(\n    style = cell_text(size = \"medium\"),\n    locations = cells_body(\n      columns = 2:4,\n      rows = c(2, 4, 6)\n    )\n  ) |>\n  tbl_theme()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gywutnqxpw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gywutnqxpw table {\n  font-family: Poppins;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gywutnqxpw thead, #gywutnqxpw tbody, #gywutnqxpw tfoot, #gywutnqxpw tr, #gywutnqxpw td, #gywutnqxpw th {\n  border-style: none;\n}\n\n#gywutnqxpw p {\n  margin: 0;\n  padding: 0;\n}\n\n#gywutnqxpw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gywutnqxpw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gywutnqxpw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gywutnqxpw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gywutnqxpw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gywutnqxpw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gywutnqxpw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gywutnqxpw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gywutnqxpw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gywutnqxpw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gywutnqxpw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gywutnqxpw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gywutnqxpw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gywutnqxpw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gywutnqxpw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gywutnqxpw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gywutnqxpw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gywutnqxpw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gywutnqxpw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gywutnqxpw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gywutnqxpw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gywutnqxpw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gywutnqxpw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gywutnqxpw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gywutnqxpw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gywutnqxpw .gt_left {\n  text-align: left;\n}\n\n#gywutnqxpw .gt_center {\n  text-align: center;\n}\n\n#gywutnqxpw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gywutnqxpw .gt_font_normal {\n  font-weight: normal;\n}\n\n#gywutnqxpw .gt_font_bold {\n  font-weight: bold;\n}\n\n#gywutnqxpw .gt_font_italic {\n  font-style: italic;\n}\n\n#gywutnqxpw .gt_super {\n  font-size: 65%;\n}\n\n#gywutnqxpw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gywutnqxpw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gywutnqxpw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gywutnqxpw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gywutnqxpw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gywutnqxpw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gywutnqxpw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#gywutnqxpw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#gywutnqxpw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\" \"> </th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Points\">Points</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"xG Difference\">xG Difference</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Goal Difference\">Goal Difference</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"4\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"&lt;div data-qmd-base64=&quot;KipQb3B1bGF0aW9uLUxldmVsIChGaXhlZCkgRWZmZWN0cyoq&quot;&gt;&lt;div class='gt_from_md'&gt;&lt;p&gt;&lt;strong&gt;Population-Level (Fixed) Effects&lt;/strong&gt;&lt;/p&gt;&#10;&lt;/div&gt;&lt;/div&gt;\"><div data-qmd-base64=\"KipQb3B1bGF0aW9uLUxldmVsIChGaXhlZCkgRWZmZWN0cyoq\"><div class='gt_from_md'><p><strong>Population-Level (Fixed) Effects</strong></p>\n</div></div></th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"**Population-Level (Fixed) Effects**   \" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"**Population-Level (Fixed) Effects**  Points\" class=\"gt_row gt_center\">60.13</td>\n<td headers=\"**Population-Level (Fixed) Effects**  xG Difference\" class=\"gt_row gt_center\">-0.09</td>\n<td headers=\"**Population-Level (Fixed) Effects**  Goal Difference\" class=\"gt_row gt_center\">13.91</td></tr>\n    <tr><td headers=\"**Population-Level (Fixed) Effects**   \" class=\"gt_row gt_left\"></td>\n<td headers=\"**Population-Level (Fixed) Effects**  Points\" class=\"gt_row gt_center\" style=\"font-size: medium;\">[53.82, 66.43]</td>\n<td headers=\"**Population-Level (Fixed) Effects**  xG Difference\" class=\"gt_row gt_center\" style=\"font-size: medium;\">[-9.24, 9.06]</td>\n<td headers=\"**Population-Level (Fixed) Effects**  Goal Difference\" class=\"gt_row gt_center\" style=\"font-size: medium;\">[3.55, 24.27]</td></tr>\n    <tr><td headers=\"**Population-Level (Fixed) Effects**   \" class=\"gt_row gt_left\">Squad Value<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;\"><sup>1</sup></span></td>\n<td headers=\"**Population-Level (Fixed) Effects**  Points\" class=\"gt_row gt_center\">18.26</td>\n<td headers=\"**Population-Level (Fixed) Effects**  xG Difference\" class=\"gt_row gt_center\">19.95</td>\n<td headers=\"**Population-Level (Fixed) Effects**  Goal Difference\" class=\"gt_row gt_center\">28.14</td></tr>\n    <tr><td headers=\"**Population-Level (Fixed) Effects**   \" class=\"gt_row gt_left\"></td>\n<td headers=\"**Population-Level (Fixed) Effects**  Points\" class=\"gt_row gt_center\" style=\"font-size: medium;\">[15.88, 20.64]</td>\n<td headers=\"**Population-Level (Fixed) Effects**  xG Difference\" class=\"gt_row gt_center\" style=\"font-size: medium;\">[16.19, 23.71]</td>\n<td headers=\"**Population-Level (Fixed) Effects**  Goal Difference\" class=\"gt_row gt_center\" style=\"font-size: medium;\">[25.19, 31.08]</td></tr>\n    <tr><td headers=\"**Population-Level (Fixed) Effects**   \" class=\"gt_row gt_left\">Time (Seasons)<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;\"><sup>2</sup></span></td>\n<td headers=\"**Population-Level (Fixed) Effects**  Points\" class=\"gt_row gt_center\">-1.86</td>\n<td headers=\"**Population-Level (Fixed) Effects**  xG Difference\" class=\"gt_row gt_center\">-0.89</td>\n<td headers=\"**Population-Level (Fixed) Effects**  Goal Difference\" class=\"gt_row gt_center\">-2.76</td></tr>\n    <tr><td headers=\"**Population-Level (Fixed) Effects**   \" class=\"gt_row gt_left\"></td>\n<td headers=\"**Population-Level (Fixed) Effects**  Points\" class=\"gt_row gt_center\" style=\"font-size: medium;\">[-2.26, -1.46]</td>\n<td headers=\"**Population-Level (Fixed) Effects**  xG Difference\" class=\"gt_row gt_center\" style=\"font-size: medium;\">[-1.48, -0.30]</td>\n<td headers=\"**Population-Level (Fixed) Effects**  Goal Difference\" class=\"gt_row gt_center\" style=\"font-size: medium;\">[-3.35, -2.16]</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"4\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"&lt;div data-qmd-base64=&quot;KipHcm91cCAoUmFuZG9tKSBFZmZlY3RzKio=&quot;&gt;&lt;div class='gt_from_md'&gt;&lt;p&gt;&lt;strong&gt;Group (Random) Effects&lt;/strong&gt;&lt;/p&gt;&#10;&lt;/div&gt;&lt;/div&gt;\"><div data-qmd-base64=\"KipHcm91cCAoUmFuZG9tKSBFZmZlY3RzKio=\"><div class='gt_from_md'><p><strong>Group (Random) Effects</strong></p>\n</div></div></th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"**Group (Random) Effects**   \" class=\"gt_row gt_left\"><div data-qmd-base64=\"X0NsdWJfOiBTbG9wZSBWYXJpYW5jZQ==\"><div class='gt_from_md'><p><em>Club</em>: Slope Variance</p>\n</div></div></td>\n<td headers=\"**Group (Random) Effects**  Points\" class=\"gt_row gt_center\">3.11</td>\n<td headers=\"**Group (Random) Effects**  xG Difference\" class=\"gt_row gt_center\">5.34</td>\n<td headers=\"**Group (Random) Effects**  Goal Difference\" class=\"gt_row gt_center\">5.32</td></tr>\n    <tr><td headers=\"**Group (Random) Effects**   \" class=\"gt_row gt_left\"><div data-qmd-base64=\"X0xlYWd1ZV86IEludGVyY2VwdCBWYXJpYW5jZQ==\"><div class='gt_from_md'><p><em>League</em>: Intercept Variance</p>\n</div></div></td>\n<td headers=\"**Group (Random) Effects**  Points\" class=\"gt_row gt_center\">6.52</td>\n<td headers=\"**Group (Random) Effects**  xG Difference\" class=\"gt_row gt_center\">8.82</td>\n<td headers=\"**Group (Random) Effects**  Goal Difference\" class=\"gt_row gt_center\">10.92</td></tr>\n    <tr><td headers=\"**Group (Random) Effects**   \" class=\"gt_row gt_left\"><div data-qmd-base64=\"X0xlYWd1ZV86IFNsb3BlIFZhcmlhbmNl\"><div class='gt_from_md'><p><em>League</em>: Slope Variance</p>\n</div></div></td>\n<td headers=\"**Group (Random) Effects**  Points\" class=\"gt_row gt_center\">2.44</td>\n<td headers=\"**Group (Random) Effects**  xG Difference\" class=\"gt_row gt_center\">3.88</td>\n<td headers=\"**Group (Random) Effects**  Goal Difference\" class=\"gt_row gt_center\">2.79</td></tr>\n    <tr><td headers=\"**Group (Random) Effects**   \" class=\"gt_row gt_left\"><div data-qmd-base64=\"X1NlYXNvbl86IEludGVyY2VwdCBWYXJpYW5jZQ==\"><div class='gt_from_md'><p><em>Season</em>: Intercept Variance</p>\n</div></div></td>\n<td headers=\"**Group (Random) Effects**  Points\" class=\"gt_row gt_center\">2.20</td>\n<td headers=\"**Group (Random) Effects**  xG Difference\" class=\"gt_row gt_center\">1.23</td>\n<td headers=\"**Group (Random) Effects**  Goal Difference\" class=\"gt_row gt_center\">3.26</td></tr>\n    <tr><td headers=\"**Group (Random) Effects**   \" class=\"gt_row gt_left\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\"><div data-qmd-base64=\"UmVzaWR1YWwgVmFyaWFuY2U=\"><div class='gt_from_md'><p>Residual Variance</p>\n</div></div></td>\n<td headers=\"**Group (Random) Effects**  Points\" class=\"gt_row gt_center\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\">8.58</td>\n<td headers=\"**Group (Random) Effects**  xG Difference\" class=\"gt_row gt_center\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\">9.30</td>\n<td headers=\"**Group (Random) Effects**  Goal Difference\" class=\"gt_row gt_center\" style=\"border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;\">12.45</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"4\" class=\"gt_empty_group_heading\" scope=\"colgroup\" id=\"\"></th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"NA   \" class=\"gt_row gt_left\">Num.Obs.</td>\n<td headers=\"NA  Points\" class=\"gt_row gt_center\">1174</td>\n<td headers=\"NA  xG Difference\" class=\"gt_row gt_center\">684</td>\n<td headers=\"NA  Goal Difference\" class=\"gt_row gt_center\">1174</td></tr>\n    <tr><td headers=\"NA   \" class=\"gt_row gt_left\">RMSE</td>\n<td headers=\"NA  Points\" class=\"gt_row gt_center\">8.20</td>\n<td headers=\"NA  xG Difference\" class=\"gt_row gt_center\">8.75</td>\n<td headers=\"NA  Goal Difference\" class=\"gt_row gt_center\">11.82</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"4\">Source: FBref &amp; Transfermarkt Via {worldfootballR}</td>\n    </tr>\n  </tfoot>\n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;\"><sup>1</sup></span> Market value log-transformed and centred around grand mean.</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;\"><sup>2</sup></span> Time represented as integers 0-11 where 2012/13 = 0 and 2022/23 = 11.</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n- Squad value is log-transformed (and centred), so coefficient is interpreted as every additional 1% increase in the squad value leads to a x/100 increase in the outcome.\n- Every 1% increase in squad value (which is an increase of around ~â‚¬2.37m) leads to a ~0.2 increase in points, ~0.2 increase in xG difference, and ~0.3 increase in goal difference.\n- Every 10% increase in squad value (which is an increase of around ~â‚¬23.7m) leads to a 1.7 increase in points, a 1.9 increase in xG difference, and a 2.7 increase in goal difference.\n\n[^MLMs]:\n\n    There are lots of different names for all these different types of models, just as there are lots of different names for multilevel models too. The names I'm using here definitely aren't the catchiest, but I think they \n    are the most intuitive, and terminology that gives practitioners and readers no hint at what they mean is a common problem with multilevel models, so I'm going to stick with the intuitive option. For a brief overview of \n    these different types of grouping structures, check out the [Multilevel Models Cheatsheet](https://paulrjohnson.net/blog/2022-11-01-multilevel-model-r-cheatsheet/) I put together a couple years ago. \n\n[^Structures]:\n\n    Nested and crossed grouping structures are another example of the flexibility and complexity that can be specified in a multilevel model. They describe the way that grouping structures relate to each other when there are \n    three or more hierarchical levels in the data. Grouping structures are nested when a lower level grouping is entirely contained within another higher level grouping, meaning that each of the lower level groups belongs to \n    only one of the higher level groups. For example, the clubs in the data we are using are entirely nested within their league. Manchester United have never broken out of their containment and run loose in the Bundesliga \n    (and while teams can be relegate, the lower tiers are not included in this data). Grouping structures are crossed, on the other hand, when the lower level grouping is not contained entirely within the higher level grouping. \n    The lower level groups can belong to any of the higher level groups (and multiple groups) when they are crossed. Seasons are crossed with leagues and teams because both can belong to every one of the seasons (and in the \n    case of the leagues, they **do** belong to each season). \n\n### Computing Predicted League Points\n\n![](arrested-development.jpg){fig-align=\"center\" width=60%}\n\nWe can compute the predicted points for each team-season from our model, to better understand the model's estimates.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Plot Code (Click to Expand)\"}\nmodels |>\n  filter(outcome == \"Points\") |> \n  tidyr::unnest(c(data, preds)) |> \n  mutate(preds = round(preds)) |> \n  tidyr::pivot_longer(\n    cols = c(value, preds), names_to = \"type\", values_to = \"points\"\n    ) |> \n  mutate(\n    type = \n      case_when(\n        type == \"value\" ~ \"Total Points\",\n        type == \"preds\" ~ \"Predicted Points\",\n        .default = type\n      )\n    # season = stringr::str_sub(season, 3, -1)\n    ) |> \n  filter(\n    squad %in% c(\n      \"Manchester City\", \"Manchester Utd\", \"Liverpool\", \n      \"Arsenal\", \"Chelsea\", \"Tottenham\"\n      )\n    ) |>\n  ggplot(aes(season, points, group = type, linetype = type)) +\n  geom_smooth(\n    method = lm, formula = y ~ splines::ns(x, 3), \n    linewidth = 0.5, se = FALSE, colour = \"#343a40\"\n    ) +\n  geom_point(aes(fill = type), shape = 21, size = 1.2, stroke = 1) +\n  guides(fill = guide_legend(override.aes = list(size = 2))) + \n  scale_fill_manual(values = c(\"white\", \"#343a40\")) +\n  scale_linetype_manual(values = c(\"dashed\", \"solid\")) +\n  scale_x_discrete(\n    expand = c(0.05, 0.05), \n    breaks = c(\"2013/14\", \"2015/16\", \"2017/18\", \"2019/20\", \"2021/22\", \"2023/24\")\n    ) +\n  facet_wrap(facets = vars(squad), nrow = 3) +\n  labs(\n    title = \"Premier League Top Six Performance Above/Below Expectations\",\n    subtitle = \n      stringr::str_wrap(\n        glue::glue(\n          \"Comparing Arsenal, Chelsea, Liverpool, Man City, Man Utd, & Spurs' total \",\n          \"and predicted points in the Premier League from 2012/23 to 2023/24, \",\n          \"conditional on each club's total market value and net spend per season.\"\n          ),\n        width = 95\n      ),\n    x = NULL, y = NULL,\n    caption = \n      \"Visualisation: Paul Johnson  |  Data: Transfermarkt Via {worldfootballR}\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/top-six-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Plot Code (Click to Expand)\"}\nmodels |>\n  filter(outcome == \"Points\") |> \n  tidyr::unnest(c(data, preds)) |> \n  mutate(preds = round(preds)) |> \n  tidyr::pivot_longer(\n    cols = c(value, preds), names_to = \"type\", values_to = \"points\"\n    ) |> \n  mutate(\n    type = \n      case_when(\n        type == \"value\" ~ \"Total Points\",\n        type == \"preds\" ~ \"Predicted Points\",\n        .default = type\n      )\n    # season = stringr::str_sub(season, 3, -1)\n    ) |> \n  filter(\n    squad %in% c(\n      \"Brighton\", \"Leicester City\", \"Southampton\", \"West Ham\"\n      )\n    ) |>\n  ggplot(aes(season, points, group = type, linetype = type)) +\n  geom_smooth(\n    method = lm, formula = y ~ splines::ns(x, 3), \n    linewidth = 0.5, se = FALSE, colour = \"#343a40\"\n    ) +\n  geom_point(aes(fill = type), shape = 21, size = 1.2, stroke = 1) +\n  guides(fill = guide_legend(override.aes = list(size = 2))) + \n  scale_fill_manual(values = c(\"white\", \"#343a40\")) +\n  scale_linetype_manual(values = c(\"dashed\", \"solid\")) +\n  scale_x_discrete(\n    expand = c(0.05, 0.05),\n    #limits = club_resources$season,\n    breaks = c(\"2013/14\", \"2015/16\", \"2017/18\", \"2019/20\", \"2021/22\", \"2023/24\")\n    ) +\n  facet_wrap(facets = vars(squad), nrow = 2, scales = \"free_x\") +\n  labs(\n    title = \"Premier League Challengers' Performance Above/Below Expectations\",\n    subtitle = \n      stringr::str_wrap(\n        glue::glue(\n          \"Comparing Brighton, Leicester, Southapmton, & West Ham's  total \",\n          \"and predicted points in the Premier League from 2012/23 to 2023/24, \",\n          \"conditional on each club's total market value and net spend per season.\"\n          ),\n        width = 95\n      ),\n    x = NULL, y = NULL,\n    caption = \n      \"Visualisation: Paul Johnson  |  Data: Transfermarkt Via {worldfootballR}\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/challengers-1.png){width=672}\n:::\n:::\n\n\n\n#### Identifying the Over & Underperformers\n\nWe're sorting the penny wise from the (billion) pound foolish!\n\n- There are lots of different routes you can take things with this because there are so many different ways to measure over/underperformance that are interesting, and both extremes are potentially worth exploring too.\n- The reason there are so many ways to approach this is because evaluating team performance could be done so many ways. Is a team that is overperforming massively in one season but is otherwise in-line with their predicted performance better off than a team that experiences small gains every single season?\n\nSome examples of potentially interesting ways to chop up this data and investigate further:\n\n- Looking at the largest single-season over/underperformers, using percentage over/underperformance.\n- Finding the teams with the most seasons of over/underperformance by counting total seasons with plus and minus performance, and considering whether this is evidence that a team has a consistently good front office.\n- Building the predicted standings for each season and seeing which teams have over/underperformed in terms of league position.\n- We could also look at total performance across all seasons, using all three outcomes (points, goals, xG).\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Function Code (Click to Expand)\"}\nperformance_table <-\n  function(min_max) {\n    models |>\n      filter(outcome == \"Points\") |>\n      tidyr::unnest(c(data, preds)) |>\n      filter(n() > 3, .by = squad) |>\n      summarise(\n        total_pts = sum(value),\n        predicted_pts = sum(preds),\n        pct_diff = (total_pts / predicted_pts) - 1,\n        .by = c(squad, league)\n      ) |>\n      min_max(order_by = pct_diff, n = 3, by = league) |>\n      select(squad, league, pct_diff) |>\n      gt(groupname_col = \"league\", rowname_col = \"squad\") |>\n      cols_label(pct_diff ~ \"% Over/Under\") |>\n      fmt_percent(columns = 3) |>\n      cols_align(align = \"right\", columns = 3) |>\n      tab_style(\n        style = cell_text(weight = \"bold\"),\n        locations = cells_row_groups()\n      ) |>\n      tbl_theme()\n  }\n```\n:::\n\n\n\n::: {.panel-tabset}\n\n##### Overperformers\n\n\n\n::: {#tbl-overperformers .cell tbl-cap='The Biggest Overperformers in the Big Five Leagues'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Table Code (Click to Expand)\"}\nperformance_table(slice_max)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ziukjkxmxg\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ziukjkxmxg table {\n  font-family: Poppins;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ziukjkxmxg thead, #ziukjkxmxg tbody, #ziukjkxmxg tfoot, #ziukjkxmxg tr, #ziukjkxmxg td, #ziukjkxmxg th {\n  border-style: none;\n}\n\n#ziukjkxmxg p {\n  margin: 0;\n  padding: 0;\n}\n\n#ziukjkxmxg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ziukjkxmxg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ziukjkxmxg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ziukjkxmxg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ziukjkxmxg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ziukjkxmxg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ziukjkxmxg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ziukjkxmxg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ziukjkxmxg .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ziukjkxmxg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ziukjkxmxg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ziukjkxmxg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ziukjkxmxg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ziukjkxmxg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ziukjkxmxg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ziukjkxmxg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ziukjkxmxg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ziukjkxmxg .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ziukjkxmxg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ziukjkxmxg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ziukjkxmxg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ziukjkxmxg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ziukjkxmxg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ziukjkxmxg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ziukjkxmxg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ziukjkxmxg .gt_left {\n  text-align: left;\n}\n\n#ziukjkxmxg .gt_center {\n  text-align: center;\n}\n\n#ziukjkxmxg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ziukjkxmxg .gt_font_normal {\n  font-weight: normal;\n}\n\n#ziukjkxmxg .gt_font_bold {\n  font-weight: bold;\n}\n\n#ziukjkxmxg .gt_font_italic {\n  font-style: italic;\n}\n\n#ziukjkxmxg .gt_super {\n  font-size: 65%;\n}\n\n#ziukjkxmxg .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ziukjkxmxg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ziukjkxmxg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ziukjkxmxg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ziukjkxmxg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ziukjkxmxg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ziukjkxmxg .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ziukjkxmxg .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ziukjkxmxg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"% Over/Under\">% Over/Under</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" style=\"font-weight: bold;\" scope=\"colgroup\" id=\"Premier League\">Premier League</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Burnley</th>\n<td headers=\"Premier League stub_1_1 pct_diff\" class=\"gt_row gt_right\">7.82%</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Leicester City</th>\n<td headers=\"Premier League stub_1_2 pct_diff\" class=\"gt_row gt_right\">5.07%</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Stoke City</th>\n<td headers=\"Premier League stub_1_3 pct_diff\" class=\"gt_row gt_right\">3.88%</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" style=\"font-weight: bold;\" scope=\"colgroup\" id=\"La Liga\">La Liga</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Girona</th>\n<td headers=\"La Liga stub_1_4 pct_diff\" class=\"gt_row gt_right\">16.20%</td></tr>\n    <tr><th id=\"stub_1_5\" scope=\"row\" class=\"gt_row gt_left gt_stub\">CÃ¡diz</th>\n<td headers=\"La Liga stub_1_5 pct_diff\" class=\"gt_row gt_right\">15.48%</td></tr>\n    <tr><th id=\"stub_1_6\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Eibar</th>\n<td headers=\"La Liga stub_1_6 pct_diff\" class=\"gt_row gt_right\">6.77%</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" style=\"font-weight: bold;\" scope=\"colgroup\" id=\"Ligue 1\">Ligue 1</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_7\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Lens</th>\n<td headers=\"Ligue 1 stub_1_7 pct_diff\" class=\"gt_row gt_right\">13.66%</td></tr>\n    <tr><th id=\"stub_1_8\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Stade Brest</th>\n<td headers=\"Ligue 1 stub_1_8 pct_diff\" class=\"gt_row gt_right\">4.93%</td></tr>\n    <tr><th id=\"stub_1_9\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bastia</th>\n<td headers=\"Ligue 1 stub_1_9 pct_diff\" class=\"gt_row gt_right\">4.75%</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" style=\"font-weight: bold;\" scope=\"colgroup\" id=\"Bundesliga\">Bundesliga</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_10\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Union Berlin</th>\n<td headers=\"Bundesliga stub_1_10 pct_diff\" class=\"gt_row gt_right\">25.31%</td></tr>\n    <tr><th id=\"stub_1_11\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Freiburg</th>\n<td headers=\"Bundesliga stub_1_11 pct_diff\" class=\"gt_row gt_right\">5.03%</td></tr>\n    <tr><th id=\"stub_1_12\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Bayern Munich</th>\n<td headers=\"Bundesliga stub_1_12 pct_diff\" class=\"gt_row gt_right\">2.43%</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" style=\"font-weight: bold;\" scope=\"colgroup\" id=\"Serie A\">Serie A</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_13\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Chievo</th>\n<td headers=\"Serie A stub_1_13 pct_diff\" class=\"gt_row gt_right\">6.48%</td></tr>\n    <tr><th id=\"stub_1_14\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Lazio</th>\n<td headers=\"Serie A stub_1_14 pct_diff\" class=\"gt_row gt_right\">4.39%</td></tr>\n    <tr><th id=\"stub_1_15\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Empoli</th>\n<td headers=\"Serie A stub_1_15 pct_diff\" class=\"gt_row gt_right\">4.16%</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"2\">Source: FBref &amp; Transfermarkt Via {worldfootballR}</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n##### Underperformers\n\n\n\n::: {#tbl-underperformers .cell tbl-cap='The Biggest Underperformers in the Big Five Leagues'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Table Code (Click to Expand)\"}\nperformance_table(slice_min)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"edubprirfo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#edubprirfo table {\n  font-family: Poppins;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#edubprirfo thead, #edubprirfo tbody, #edubprirfo tfoot, #edubprirfo tr, #edubprirfo td, #edubprirfo th {\n  border-style: none;\n}\n\n#edubprirfo p {\n  margin: 0;\n  padding: 0;\n}\n\n#edubprirfo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#edubprirfo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#edubprirfo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#edubprirfo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#edubprirfo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#edubprirfo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#edubprirfo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#edubprirfo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#edubprirfo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#edubprirfo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#edubprirfo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#edubprirfo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#edubprirfo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#edubprirfo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#edubprirfo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#edubprirfo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#edubprirfo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#edubprirfo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#edubprirfo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#edubprirfo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#edubprirfo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#edubprirfo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#edubprirfo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#edubprirfo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#edubprirfo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#edubprirfo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#edubprirfo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#edubprirfo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#edubprirfo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#edubprirfo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#edubprirfo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#edubprirfo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#edubprirfo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#edubprirfo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#edubprirfo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#edubprirfo .gt_left {\n  text-align: left;\n}\n\n#edubprirfo .gt_center {\n  text-align: center;\n}\n\n#edubprirfo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#edubprirfo .gt_font_normal {\n  font-weight: normal;\n}\n\n#edubprirfo .gt_font_bold {\n  font-weight: bold;\n}\n\n#edubprirfo .gt_font_italic {\n  font-style: italic;\n}\n\n#edubprirfo .gt_super {\n  font-size: 65%;\n}\n\n#edubprirfo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#edubprirfo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#edubprirfo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#edubprirfo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#edubprirfo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#edubprirfo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#edubprirfo .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#edubprirfo .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#edubprirfo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"% Over/Under\">% Over/Under</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" style=\"font-weight: bold;\" scope=\"colgroup\" id=\"Premier League\">Premier League</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Norwich City</th>\n<td headers=\"Premier League stub_1_1 pct_diff\" class=\"gt_row gt_right\">âˆ’12.21%</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Sunderland</th>\n<td headers=\"Premier League stub_1_2 pct_diff\" class=\"gt_row gt_right\">âˆ’11.08%</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Fulham</th>\n<td headers=\"Premier League stub_1_3 pct_diff\" class=\"gt_row gt_right\">âˆ’10.00%</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" style=\"font-weight: bold;\" scope=\"colgroup\" id=\"La Liga\">La Liga</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Deportivo de La CoruÃ±a</th>\n<td headers=\"La Liga stub_1_4 pct_diff\" class=\"gt_row gt_right\">âˆ’10.29%</td></tr>\n    <tr><th id=\"stub_1_5\" scope=\"row\" class=\"gt_row gt_left gt_stub\">AlmerÃ­a</th>\n<td headers=\"La Liga stub_1_5 pct_diff\" class=\"gt_row gt_right\">âˆ’9.16%</td></tr>\n    <tr><th id=\"stub_1_6\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Las Palmas</th>\n<td headers=\"La Liga stub_1_6 pct_diff\" class=\"gt_row gt_right\">âˆ’8.45%</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" style=\"font-weight: bold;\" scope=\"colgroup\" id=\"Ligue 1\">Ligue 1</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_7\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Troyes</th>\n<td headers=\"Ligue 1 stub_1_7 pct_diff\" class=\"gt_row gt_right\">âˆ’9.52%</td></tr>\n    <tr><th id=\"stub_1_8\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Toulouse</th>\n<td headers=\"Ligue 1 stub_1_8 pct_diff\" class=\"gt_row gt_right\">âˆ’6.91%</td></tr>\n    <tr><th id=\"stub_1_9\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Metz</th>\n<td headers=\"Ligue 1 stub_1_9 pct_diff\" class=\"gt_row gt_right\">âˆ’4.76%</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" style=\"font-weight: bold;\" scope=\"colgroup\" id=\"Bundesliga\">Bundesliga</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_10\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Hamburger SV</th>\n<td headers=\"Bundesliga stub_1_10 pct_diff\" class=\"gt_row gt_right\">âˆ’9.64%</td></tr>\n    <tr><th id=\"stub_1_11\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Schalke</th>\n<td headers=\"Bundesliga stub_1_11 pct_diff\" class=\"gt_row gt_right\">âˆ’9.49%</td></tr>\n    <tr><th id=\"stub_1_12\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Hannover 96</th>\n<td headers=\"Bundesliga stub_1_12 pct_diff\" class=\"gt_row gt_right\">âˆ’8.79%</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"2\" class=\"gt_group_heading\" style=\"font-weight: bold;\" scope=\"colgroup\" id=\"Serie A\">Serie A</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_13\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Genoa</th>\n<td headers=\"Serie A stub_1_13 pct_diff\" class=\"gt_row gt_right\">âˆ’6.33%</td></tr>\n    <tr><th id=\"stub_1_14\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Palermo</th>\n<td headers=\"Serie A stub_1_14 pct_diff\" class=\"gt_row gt_right\">âˆ’5.26%</td></tr>\n    <tr><th id=\"stub_1_15\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Cagliari</th>\n<td headers=\"Serie A stub_1_15 pct_diff\" class=\"gt_row gt_right\">âˆ’4.58%</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"2\">Source: FBref &amp; Transfermarkt Via {worldfootballR}</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n:::\n\n## Wrapping Up\n\nI started this blog post unclear as to whether I was writing a multilevel regression tutorial using football data as the example, or an analysis of the money in football using a multilevel regression. I'm still not entirely sure which it is. Maybe this is a Choose Your Own Adventure blog post for nerds? Whichever adventure you chose, I hope you enjoyed it. And if you didn't, please don't write mean things about me on the Internet.\n\nNext up - a Bayesian attempt at this!\n\n## Acknowledgments {.appendix}\n\nPreview image by [Robert Anasch](https://unsplash.com/@diesektion) on [Unsplash](https://unsplash.com/photos/100-banknote-lot-Wnp7qnhHtyw).\n\n## Support {.appendix}\n\nIf you enjoyed this blog post and would like to support my work, you can [buy me a coffee or a beer or give me a tip](https://www.buymeacoffee.com/paulj1989) as a thank you. \n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}